<!-- Generated by SpecStory -->

# Removing comments from CSS file (2025-07-13 04:36Z)

_**User**_

remove comments

---

_**Assistant**_

````css
body {
    font-family: Arial, sans-serif;
    background: url("../images/bsu1.jpg") no-repeat center center fixed;
    background-size: cover;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}

.overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: -1;
}

.container {
    background: rgba(255, 255, 255, 0.95);
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.3);
    width: 50%;
    text-align: center;
}

h1 {
    margin-bottom: 15px;
    color: #2c3e50;
    font-size: 24px;
}

#success-message {
    display: none;
    color: #27ae60;
    font-weight: bold;
    margin-bottom: 15px;
    padding: 10px;
    background: #eafaf1;
    border-radius: 5px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

th {
    background-color: #0056b3;
    color: white;
}

tr:nth-child(even) {
    background-color: #f8f9fa;
}

tr:hover {
    background-color: #ecf0f1;
}

button {
    margin-top: 15px;
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    transition: 0.3s;
}

.delete-btn {
    background-color: #c82333;
    color: white;
}

.delete-btn:hover {
    background-color: #c0392b;
}

.return-btn {
    background-color: #0056b3;
    color: white;
}

.return-btn:hover {
    background-color: #2980b9;
}

@media (max-width: 768px) {
    .container {
        width: 90%;
    }
}
````

---

_**User**_

remove comments

---

_**Assistant**_

````css
body {
  font-family: Arial, sans-serif;
  background-color: #f4f4f9;
  margin: 0;
  padding: 0;
  color: #333;
  background-image: url(bsu1.jpg);
  background-repeat: no-repeat;
  background-size: cover;
}

h1 {
  color: #7b0606;
  margin-top: 20px;
  margin-left: 448px;
  padding: 10px 20px;
  background-color: #fff;
  border-radius: 8px;
  display: inline-block;
}

.container {
  max-width: 800px;
  margin: 20px auto;
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

h2 {
  color: #7b0606;
  margin-bottom: 10px;
  border-bottom: 2px solid #7b0606;
  display: inline-block;
  padding-bottom: 5px;
  text-align: center;
  justify-content: center;
  display: flex;
}

p {
  margin: 10px 0;
  font-size: 16px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

table thead th {
  background-color: #7b0606;
  color: white;
  text-align: left;
  padding: 10px;
  border: 1px solid #ddd;
}

table thead th:first-child {
  background-color: #067b06;
  color: #ffffff;
}

table tbody td {
  padding: 10px;
  border: 1px solid #ddd;
}

table tbody tr:nth-child(even) {
  background-color: #f9f9f9;
}

table tbody tr:hover {
  background-color: #f1f1f1;
}

.timestamp {
  font-family: 'Courier New', Courier, monospace;
  color: #555;
}

.action-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 20px 0;
}

#downloadButton, #homeButton {
  background-color: #7b0606;
  color: #ffffff;
  border: none;
  border-radius: 5px;
  padding: 10px 0;
  font-size: 16px;
  cursor: pointer;
  width: 180px;
  text-align: center;
}
.action-buttons a {
  text-decoration: none;
  color: inherit;
}

.action-buttons a:visited {
  text-decoration: none;
  color: inherit;
}
#homeButton {
  background-color: #6c757d;
}

#downloadButton:hover {
  background-color: #9c2727;
}

#homeButton:hover {
  background-color: #5a6268;
}

@media (max-width: 600px) {
  .container {
    padding: 10px;
  }

  h1, h2 {
    font-size: 20px;
  }

  p {
    font-size: 14px;
  }

  table {
    font-size: 12px;
  }
}

@media print {
  #downloadButton, #homeButton {
    display: none;
  }
}

#resetButton {
  background-color: #FD7E14;
  color: white;
  border-radius: 5px;
  cursor: pointer;
}

@media print {
  #resetButton {
    display: none;
  }
}

#resetButton:hover {
  background-color: #d67c32;
}

button:active {
  transform: scale(0.95);
}
````

---

_**User**_

remove comments

---

_**Assistant**_

````css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  text-decoration: none;
  border: none;
  outline: none;
  scroll-behavior: smooth;
}

:root {
  --bg-color: #610707;
  --second-bg-color: #fff6f7;
  --text-color: #2a2420;
  --main-color: #a63f42;
  --second-text-color: #d9d8d5;
}

section {
  min-height: 100vh;
  padding: 5rem 15%;
}

.header {
  position: fixed;
  top: 0;
  left: 0;
  padding: 1rem 5%;
  color: #fff6f7;
  background-color: #610707;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 100;
  width: 100%;
}

#bx-filter-alt {
  cursor: pointer;
  font-size: 1.3rem;
  justify-content: center;
  align-items: center;
  color: var(--second-bg-color);
  margin-left: 1rem;
}

.filter-bar-container {
  position: fixed;
  top: 100px;
  width: 100%;
  padding-right: 85px;
  display: flex;
  justify-content: right;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  z-index: 100;
}
.amenities-title {
  grid-column: span 2;
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--main-color);
  margin-bottom: 1rem;
  text-align: center;
  border-bottom: 2px solid var(--main-color);
  padding-bottom: 0.5rem;
}

.filter-bar {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  background-color: var(--second-bg-color);
  border: 2px solid var(--main-color);
  border-radius: 1rem;
  padding: 1rem 2rem;
  width: auto;
  max-width: 50%;
}

.department-title, .amenities-title {
  grid-column: span 2;
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--main-color);
  margin-bottom: 1rem;
  text-align: center;
  border-bottom: 2px solid var(--main-color);
  padding-bottom: 0.5rem;
}

.filter-bar label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 15px;
  color: var(--text-color);
}

filter-bar input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
}

.filter-bar .filter-btn {
  background-color: var(--main-color);
  color: var(--second-bg-color);
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  cursor: pointer;
  font-size: 1rem;
  align-self: flex-start;
 
}
.filter-bar .filter-btn:hover{
  background-color: var(--bg-color);
}
.filter-bar-container.active {
  opacity: 1;
  visibility: visible;
}


.navbar a {
  font-size: 1.7rem;
  color: var(--second-text-color);
  margin-left: 4rem;
  font-weight: 500;
  transition: 0.3s ease;
  border-bottom: 3px solid transparent;
}

.navbar a:hover,
.navbar a.active {
  color: var(--main-color);
  border-bottom: 3px solid var(--main-color);
}


body {
  font-family: Arial, sans-serif;
  margin: 20px;
}

html {
  overflow: hidden;
}

h1 {
  text-align: center;
}

.rooms-container {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center;
  margin-top: 30px;
}

.room-box {
  width: 200px;
  height: 120px;
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s;
}

.room-box.vacant {
  background-color: green;
}

.room-box.occupied {
  background-color: red;
}

.room-box:hover {
  transform: scale(1.05);
}

.room-number {
  font-size: 24px;
}

.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.5);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background-color: white;
  padding: 20px;
  border-radius: 10px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  text-align: center;
  position: relative;
}

.close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 24px;
  cursor: pointer;
}


.save-btn {
  background-color: green;
  color: white;
  margin-right: 10px;
}

.cancel-btn {
  background-color: red;
  color: white;
}

.container {
  position: relative;
  max-width: 1350px;
  width: 100%;
  text-align: center;
  margin: 10px 50px auto;
}

.filter_buttons {
  display: flex;
  align-items: center;
  gap: 15px;
}

button {
  padding: 10px 20px;
  font-size: 14px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 6px;
  cursor: pointer;
}

input[type="text"] {
  padding: 10px 15px;
  width: 300px;
  border: 1px solid #ddd;
  border-radius: 6px;
}


.btn {
  background-color: var(--bg-color);
  color: white;
  padding: 10px 15px;
  margin-right: 5px;
  border: 1px solid #ddd;
  border-radius: 6px;
}

.btn:hover {
  background-color: var(--main-color);
}
.hamburger {
  display: none;
  font-size: 1.8rem;
  color: var(--second-bg-color);
  cursor: pointer;
}

.mobile-menu {
  display: none;
  flex-direction: column;
  gap: 1rem;
  background-color: var(--bg-color);
  padding: 1rem;
  position: absolute;
  top: 100%;
  right: 0;
  width: 50%;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 100;
  border-bottom-left-radius: 20px;
}

.mobile-menu input[type="text"] {
  width: 100%;
  padding: 0.5rem;
  border-radius: 5px;
  border: 1px solid #ddd;
}

.mobile-menu .btn {
  font-size: 1rem;
  padding: 0.5rem 1rem;
}

@media (max-width: 768px) {
  header h1{
    font-size: 1.3rem;
  }
  .navbar .btn{
    display: none;
  }
  .navbar #search-input{
    display: none;
  }
 
  .navbar h1{
    font-size: 1rem;
  }
  .hamburger {
    display: block;
  }

  .mobile-menu {
    display: none;
  }

  .mobile-menu.active {
    display: flex;
  }
  .filter-bar {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    padding: 0.5rem;
    max-width: 95%;
  }

  .filter-bar-container {
    padding-right: 30px;
  }

  .filter-bar label {
    font-size: 11px;
    gap: 4px;
  }

  .filter-bar input[type="checkbox"] {
    width: 16px;
    height: 16px;
  }

  .filter-bar .filter-btn {
    font-size: 0.8rem;
    padding: 0.4rem 0.8rem;
  }
}

.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.5);
}
.modal-content h2{
 display: flex;
  justify-content: center;
}
.modal-content {
  background-color: white;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 50%;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
  text-align: left;
    position: relative;
}

.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.details-panel {
  position: fixed;
  top: 20%;
  left: 50%;
  transform: translate(-50%, -20%);
  background: #fff;
  border: 1px solid #ccc;
  padding: 20px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  z-index: 1000;
}

.room-box {
  cursor: pointer;
}

.add-room {
  display: inline-block;
  margin-right: 1px;
}

.room-timer {
  margin-top: 10px;
  font-size: 14px;
  color: #555;
}


.popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: white;
  border: 2px solid #ccc;
  padding: 20px;
  z-index: 1000;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  border-radius: 8px;
}

.popup.hidden {
  display: none;
}

#popup-content {
  display: flex;
  flex-direction: column;
  align-items: center;
}

#close-popup {
  margin-bottom: 10px;
  cursor: pointer;
}

#details-container {
  display: none;
}

#details-container.hidden {
  display: none;
}

#timer-box {
  background-color: #333;
  color: #fff;
  padding: 10px 20px;
  border-radius: 8px;
  text-align: center;
  font-size: 18px;
  font-weight: bold;
  display: inline-block;
  min-width: 120px;
  margin: 10px 0;
  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
}
````

---

_**User**_

remove comments

---

_**Assistant**_

````css
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: url('/static/images/bsu1.jpg');
  background-repeat: no-repeat;
  background-size: cover;
  background-attachment: fixed;
  background-position: center center;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
  padding: 20px;
}

.container {
  background-color: rgba(255, 255, 255, 0.906);
  padding: 20px;
  border-radius: 10px;
  width: 400px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  max-height: calc(100vh - 40px);
  overflow-y: auto;
}

h1 {
  color: #333;
  text-align: center;
}

form {
  margin-top: 20px;
}

label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

input[type="text"] {
  width: 100%;
  padding: 10px;
  margin: 10px 0 15px 0;
  border: 1px solid #ddd;
  border-radius: 5px;
  box-sizing: border-box;
}

button {
  padding: 10px 20px;
  background-color: #007BFF;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  width: 100%;
  margin-top:5px;
}

button:hover {
  background-color: #0056b3;
}

ul {
  list-style: none;
  padding: 10px;
  color: #d9534f;
  font-weight: bold;
  margin: 10px 0; 
}

.return-button {
  display: flex;
  margin-top: 10px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  width: 100%;
  justify-content: center;
}

.return-button a {
  text-decoration: none;
}

.return-button button {
  background-color: #6c757d;
  width: auto;
  padding: 10px 20px;
}

.return-button button:hover {
  background-color: #5a6268;
}

.dropdown {
  margin-bottom: 15px;
  position: relative;
}

.dropdown-btn {
  width: 100%;
  padding: 10px 15px;
  margin: 1px 0 15px 0;
  border: 1px solid #ddd;
  border-radius: 5px;
  background-color: #fff;
  color: #333;
  font-size: 14px;
  cursor: pointer;
  text-align: left;
  box-sizing: border-box;
  font-size: 14px;
}

.dropdown-btn i {
  font-size: 18px;
  color: #333;
  margin-left: 10px;
}

.dropdown-btn:hover {
  background-color: #e6e6e6;
}

.dropdown-content {
  display: none;
  position: absolute;
  z-index: 1;
  background-color: white;
  padding: 10px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  width: 100%;
}

.dropdown-content label {
  display: block;
  margin: 5px 0;
  font-size: 14px;
  cursor: pointer;
}

.dropdown-content input[type="checkbox"] {
  transform: scale(1.2);
  margin-right: 15px;
}
.dropdown i{
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 10px;
  color: #5a6268;
}
.department-option {
  display: flex;
  align-items: center;
  padding: 10px;
  border-radius: 5px;
  cursor: pointer;
}

.department-option:hover {
  background-color: #f0f0f0;
}

.dropdown.open .dropdown-content {
  display: block;
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.flash-message {
  padding: 10px;
  margin: 10px 0;
  border-radius: 5px;
}
.flash-success {
  background-color: #d4edda;
  color: #155724;
}
.flash-error {
  background-color: #f8d7da;
  color: #721c24;
}
select {
  width: 100%;
  padding: 10px 10px;
  margin: 1px 0 15px 0;
  border: 1px solid #ddd;
  border-radius: 5px;
  background-color: #fff;
  color: #333;
  font-size: 14px;
  cursor: pointer;
  box-sizing: border-box;
}

select:hover {
  background-color: #e6e6e6;
}

select option {
  padding: 10px;
  font-size: 14px;
  background-color: #fff;
  color: #333;
  border: none;
}

select option:hover {
  background-color: #f0f0f0;
}

select:focus {
  outline: none;
  border-color: #007BFF;
}

select option:checked {
  background-color: #007BFF;
  color: white;
}

.dropdown-content label,
.dropdown-content .department-option {
  display: block;
  padding: 5px 10px;
  cursor: pointer;
}

.dropdown-content label:hover,
.dropdown-content .department-option:hover {
  background-color: #f0f0f0;
}

#amenities-list, #department-list {
  display: none;
}
.room-capacity {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: -10px;
  margin-bottom: 5px;
}

.room-capacity label {
  font-weight: bold;
  margin-right: 10px;
  white-space: nowrap;
}

room-capacity input {
  width: 500px;
  padding: 8px;
  border: 2px solid #ddd;
  border-radius: 5px;
  text-align: center;
  font-size: 16px;
}

.room-capacity input:focus {
  outline: none;
  border-color: #007BFF;
  box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
}
````

---

_**User**_

only place necessary comments like for standard practice

---

_**Assistant**_

````python
import os
from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from flask_socketio import SocketIO
from flask_migrate import Migrate
from sqlalchemy import create_engine, text

db = SQLAlchemy()
socketio = SocketIO()
migrate = Migrate()

def setup_database():
    db_path = os.path.abspath('instance/classrooms.db')
    engine = create_engine(f'sqlite:///{db_path}')
    with engine.connect() as connection:
        connection.execute(text("PRAGMA journal_mode=WAL;"))

def create_app():
    app = Flask(__name__)

    # App configuration
    app.configSECRET_KEY'] = 'your_secret_key'
    app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///classrooms.db'
    app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

    db.init_app(app)
    socketio.init_app(app)
    migrate.init_app(app, db)

    setup_database()

    # Register Blueprints
    from app.routes import main, auth
    app.register_blueprint(main, url_prefix='/')
    app.register_blueprint(auth, url_prefix='/auth')

    return app
````

---

_**User**_

only place necessary comments like for standard practice

---

_**Assistant**_

````python
from app import db
from werkzeug.security import generate_password_hash, check_password_hash
from datetime import datetime, timedelta
import pytz
from sqlalchemy.orm import relationship

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(64), unique=True, nullable=False)
    password_hash = db.Column(db.String(128), nullable=False)

    def set_password(self, password):
        self.password_hash = generate_password_hash(password)

    def check_password(self, password):
        return check_password_hash(self.password_hash, password)

class Room(db.Model):
    __tablename__ = 'room'
    id = db.Column(db.Integer, primary_key=True)
    room_number = db.Column(db.String(10), unique=True, nullable=False)
    status = db.Column(db.String(20), nullable=False, default='Vacant')
    occupied_since = db.Column(db.DateTime)
    room_capacity = db.Column(db.Integer, nullable=False, default=30)

    professors = db.relationship('Professor', back_populates='room')
    amenities = db.relationship(
        'Amenity',
        secondary='room_amenities',
        back_populates='rooms'
    )
    department_id = db.Column(db.Integer, db.ForeignKey('departments.id'), nullable=True)
    department = db.relationship('Department', back_populates='rooms')
    occupied_start_time = db.Column(db.DateTime, nullable=True)
    occupied_end_time = db.Column(db.DateTime, nullable=True)
    occupancy_history = db.relationship('RoomOccupancy', back_populates='room', cascade='all, delete-orphan')
    rfids = db.relationship('RoomRFID', back_populates='room', cascade='all, delete-orphan', passive_deletes=True)

class RoomOccupancy(db.Model):
    __tablename__ = 'room_occupancy'
    id = db.Column(db.Integer, primary_key=True)
    room_id = db.Column(db.Integer, db.ForeignKey('room.id'), nullable=False)
    start_time = db.Column(db.DateTime, nullable=False)
    end_time = db.Column(db.DateTime, nullable=True)
    room = db.relationship('Room', back_populates='occupancy_history')
    professor_name = db.Column(db.String(100))

class Professor(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    rfid_tag = db.Column(db.String(100), db.ForeignKey('room_rfid.rfid_tag', ondelete='CASCADE'), nullable=False)
    room_id = db.Column(db.Integer, db.ForeignKey('room.id'), nullable=False)
    room = db.relationship('Room', back_populates='professors')
    room_rfid = db.relationship('RoomRFID', back_populates='assigned_professors')

class RFIDLog(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    professor_id = db.Column(db.Integer, db.ForeignKey('professor.id'))
    room_id = db.Column(db.Integer, db.ForeignKey('room.id'))
    timestamp = db.Column(db.DateTime, nullable=False, default=db.func.now())

class RoomRFID(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    room_id = db.Column(db.Integer, db.ForeignKey('room.id', ondelete='CASCADE'), nullable=False)
    rfid_tag = db.Column(db.String(100), nullable=False, unique=True)
    name = db.Column(db.String(100))
    room = db.relationship('Room', back_populates='rfids')
    assigned_professors = db.relationship('Professor', back_populates='room_rfid', cascade="all, delete")

class Amenity(db.Model):
    __tablename__ = 'amenities'
    id = db.Column(db.Integer, primary_key=True, autoincrement=True)
    name = db.Column(db.String(255), unique=True, nullable=False)
    rooms = db.relationship(
        'Room',
        secondary='room_amenities',
        back_populates='amenities'
    )

class Department(db.Model):
    __tablename__ = 'departments'
    id = db.Column(db.Integer, primary_key=True, autoincrement=True)
    name = db.Column(db.String(255), unique=True, nullable=False)
    rooms = db.relationship('Room', back_populates='department')

# Association table for Room and Amenity many-to-many relationship
room_amenities = db.Table(
    'room_amenities',
    db.Column('room_id', db.Integer, db.ForeignKey('room.id'), primary_key=True),
    db.Column('amenity_id', db.Integer, db.ForeignKey('amenities.id'), primary_key=True)
)
````

---

_**User**_

only place necessary comments like for standard practice

---

_**Assistant**_

````python
from flask import Blueprint, render_template, request, redirect, url_for, jsonify, flash, session, make_response, current_app as app, Flask, Response, get_flashed_messages
from app import db, socketio
from app.models import Room, User, Amenity, Department, RoomOccupancy, room_amenities, Professor, RoomRFID, db
from sqlalchemy.exc import IntegrityError
from functools import wraps
from flask_wtf.csrf import generate_csrf
import pytz, sqlite3
from datetime import datetime, timezone
from sqlalchemy.sql import text
from sqlalchemy.orm import joinedload
from sqlalchemy import func, desc, extract

main = Blueprint('main', __name__)
auth = Blueprint('auth', __name__)

utc = pytz.UTC
local_tz = pytz.timezone('Asia/Singapore')
naive_datetime = datetime.now()
aware_datetime = local_tz.localize(naive_datetime)

def nocache(view):
    """Decorator to prevent caching of a view."""
    @wraps(view)
    def no_cache_response(*args, **kwargs):
        response = make_response(view(*args, **kwargs))
        response.headers["Cache-Control"] = "no-store, no-cache, must-revalidate, post-check=0, pre-check=0, max-age=0"
        response.headers["Pragma"] = "no-cache"
        response.headers["Expires"] = "0"
        return response
    return no_cache_response

@main.route('/')
def home():
    rooms = Room.query.all()
    amenities = Amenity.query.all()
    departments = Department.query.all()

    for room in rooms:
        if room.status == 'Occupied':
            result = db.session.execute(text("""
                SELECT professor_name
                FROM room_occupancy
                WHERE room_id = :room_id
                ORDER BY start_time DESC
                LIMIT 1
            """), {'room_id': room.id}).fetchone()
            room.professor_name = result[0] if result else "Unknown"
        else:
            room.professor_name = "Unknown"

    return render_template('index.html', rooms=rooms, amenities=amenities, departments=departments)

def login_required(f):
    """Custom login_required decorator using session."""
    @wraps(f)
    def decorated_function(*args, **kwargs):
        if not session.get("isLoggedIn"):
            flash("You need to log in first!", "danger")
            return redirect(url_for("auth.login"))
        return f(*args, **kwargs)
    return decorated_function

@main.route('/update_room/<int:room_id>', methods=['GET', 'POST'])
@login_required
def update_room(room_id):
    room = Room.query.get_or_404(room_id)

    if not room:
        flash('Room not found.', 'error')
        return redirect(url_for('main.dashboard'))

    amenities = Amenity.query.all()
    selected_amenities = [amenity.id for amenity in room.amenities]
    departments = Department.query.all()

    if request.method == 'POST':
        room_name = request.form.get('room_name', '').strip()
        department_id = request.form.get('department')
        selected_amenity_ids = request.form.getlist('amenities')
        room_capacity = request.form.get('room_capacity')

        # Validate and update room name
        if room_name:
            if Room.query.filter(Room.room_number == room_name, Room.id != room_id).first():
                flash('A room with this name already exists!', 'error')
                return redirect(url_for('main.update_room', room_id=room_id))
            room.room_number = room_name
        else:
            flash('Room name cannot be empty.', 'error')
            return redirect(url_for('main.update_room', room_id=room_id))

        # Validate and update room capacity
        if room_capacity and room_capacity.isnumeric():
            room.room_capacity = int(room_capacity)
        else:
            flash('Invalid room capacity. Please enter a valid number.', 'error')
            return redirect(url_for('main.update_room', room_id=room_id))

        # Update department if provided
        if department_id and department_id.isdigit():
            room.department_id = int(department_id)
        else:
            room.department_id = None

        # Update amenities
        db.session.execute(
            room_amenities.delete().where(room_amenities.c.room_id == room_id)
        )
        if selected_amenity_ids:
            for amenity_id in selected_amenity_ids:
                db.session.execute(
                    room_amenities.insert().values(room_id=room_id, amenity_id=amenity_id)
                )

        try:
            db.session.commit()
            flash('Room updated successfully!', 'success')
            return redirect(url_for('main.dashboard'))
        except Exception as e:
            db.session.rollback()
            flash(f'Error updating room: {str(e)}', 'danger')

    return render_template(
        'update_room.html',
        room=room,
        amenities=amenities,
        selected_amenities=selected_amenities,
        departments=departments
    )

@main.route('/update_room_status', methods=['GET'])
def update_room_status():
    rfid_tag = request.args.get('rfid_tag')
    room_id_from_esp = request.args.get('room_id')

    print(f"\n[INFO] Request received at {datetime.now().isoformat()}")
    print(f"[INFO] Incoming RFID: {rfid_tag}, Room ID: {room_id_from_esp}")

    if not rfid_tag or not room_id_from_esp:
        return jsonify({'status': 'error', 'message': 'Missing RFID tag or Room ID.'}), 400

    try:
        room_id = int(room_id_from_esp)
    except ValueError:
        return jsonify({'status': 'error', 'message': 'Invalid room ID format.'}), 400

    try:
        room = db.session.query(Room).with_for_update().get(room_id)
        if not room:
            return jsonify({'status': 'error', 'message': 'Room not found.'}), 404

        assigned_room = RoomRFID.query.filter_by(rfid_tag=rfid_tag, room_id=room_id).first()
        if not assigned_room:
            socketio.emit('unregistered_tag_scanned', {
                'rfid_tag': rfid_tag.lower(),
                'name': 'Unknown',
                'room_name': room.room_number,
                'message': 'This RFID tag is not registered for this room.'
            }, namespace="/")
            return jsonify({'status': 'error', 'message': 'Unauthorized tag for this room.'}), 403

        tag_holder_name = assigned_room.name if assigned_room.name else "Unknown"

        if room.status == 'Vacant':
            room.status = 'Occupied'
            room.occupied_since = datetime.utcnow()
            room.occupied_end_time = None

            temp_record = RoomOccupancy(
                room_id=room.id,
                start_time=datetime.utcnow(),
                professor_name=tag_holder_name
            )
            db.session.add(temp_record)
        elif room.status == 'Occupied':
            room.status = 'Vacant'
            occupied_start_time = room.occupied_since
            occupied_end_time = datetime.utcnow()

            last_record = RoomOccupancy.query.filter_by(room_id=room.id).order_by(desc(RoomOccupancy.id)).first()
            if last_record and last_record.end_time is None:
                last_record.end_time = occupied_end_time

            room.occupied_since = None
            room.occupied_end_time = occupied_end_time

        db.session.commit()

        socketio.emit('room_status_updated', {
            'room_id': room.id,
            'room_number': room.room_number,
            'status': room.status,
            'occupied_since': room.occupied_since.isoformat() if room.occupied_since else None,
            'professor_name': tag_holder_name,
            'rfid_tag': rfid_tag
        }, namespace="/")

        print(f"[SUCCESS] Room {room.room_number} status updated to {room.status} for RFID {rfid_tag}")

        return jsonify({
            'status': 'success',
            'message': f'Room {room.room_number} status updated to {room.status}.',
            'room_id': room.id
        }), 200

    except Exception as e:
        db.session.rollback()
        print(f"[ERROR] update_room_status failed: {str(e)}")
        return jsonify({'status': 'error', 'message': 'Server error occurred.'}), 500

@main.route('/get_room_status', methods=['GET'])
def get_room_status():
    rooms = Room.query.all()
    room_data = []

    for room in rooms:
        current_occupant = RoomOccupancy.query.filter_by(room_id=room.id, end_time=None).order_by(RoomOccupancy.start_time.desc()).first()
        professor_name = current_occupant.professor_name if current_occupant else "Unknown"

        room_data.append({
            'room_id': room.id,
            'room_number': room.room_number,
            'status': room.status,
            'occupied_since': room.occupied_since.isoformat() if room.occupied_since else None,
            'professor_name': professor_name
        })

    return jsonify(room_data)

@main.route('/dashboard')
def dashboard():
    if 'user_id' not in session:
        return redirect(url_for('auth.login'))

    rooms = Room.query.all()
    departments = Department.query.all()
    amenities = Amenity.query.all()

    response = Response(render_template(
        "dashboard.html",
        rooms=rooms,
        departments=departments,
        amenities=amenities,
        selected_departments=[],
        selected_amenities=[],
        messages=get_flashed_messages(with_categories=True)
    ))

    response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, max-age=0'
    response.headers['Pragma'] = 'no-cache'
    response.headers['Expires'] = '0'

    return response

@auth.route('/login', methods=['GET', 'POST'])
def login():
    if 'user_id' in session:
        return redirect(url_for('main.dashboard'))

    if request.method == 'POST':
        username = request.form['username']
        password = request.form['password']
        user = User.query.filter_by(username=username).first()

        if user and user.check_password(password):
            session['user_id'] = user.id
            session['isLoggedIn'] = True
            flash('Login successful!', 'success')
            return redirect(url_for('main.dashboard'))
        flash('Invalid username or password.', 'error')

    response = Response(render_template('login.html'))
    response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, max-age=0'
    response.headers['Pragma'] = 'no-cache'
    response.headers['Expires'] = '0'
    return response

@auth.route('/logout', methods=['GET'])
def logout():
    if 'user_id' in session:
        session.pop('user_id', None)
    session.pop('isLoggedIn', None)
    session.clear()
    flash('You have been logged out.', 'success')
    return redirect(url_for('auth.login'))

@auth.route('/check_login_status', methods=['GET'])
def check_login_status():
    is_logged_in = session.get('isLoggedIn', False)
    return jsonify({'isLoggedIn': is_logged_in})

@auth.route('/register', methods=['GET', 'POST'])
def register():
    if request.method == 'POST':
        username = request.form.get('username', '').strip()
        password = request.form.get('password', '').strip()

        if not username or not password:
            flash('Both username and password are required.', 'error')
            return redirect(url_for('auth.register'))

        if User.query.filter_by(username=username).first():
            flash('Username already exists.', 'error')
            return redirect(url_for('auth.register'))

        new_user = User(username=username)
        new_user.set_password(password)
        try:
            db.session.add(new_user)
            db.session.commit()
            flash('Registration successful!', 'success')
            return redirect(url_for('auth.login'))
        except Exception:
            db.session.rollback()
            flash('Error during registration.', 'error')

    return render_template('register.html')

@main.route('/add_amenity', methods=['POST'])
def add_amenity():
    data = request.get_json()
    amenity_name = data.get('name', '').strip()

    if not amenity_name:
        return jsonify(success=False, message="Amenity name cannot be empty.")

    existing_amenity = Amenity.query.filter_by(name=amenity_name).first()
    if existing_amenity:
        return jsonify(success=False, message="Amenity already exists.")

    new_amenity = Amenity(name=amenity_name)
    try:
        db.session.add(new_amenity)
        db.session.commit()
        print("Amenity added:", new_amenity)
        return jsonify(success=True, message="Amenity added successfully.")
    except IntegrityError:
        db.session.rollback()
        return jsonify(success=False, message="Database error.")
    socketio.emit('amenity_udpated')

from flask import jsonify, current_app as app

@main.route('/get_amenities', methods=['GET'])
def get_amenities():
    try:
        amenities = Amenity.query.all()
        app.logger.debug("Raw amenities query: %s", amenities)
        amenities_list = [
            {"id": amenity.id, "name": amenity.name}
            for amenity in amenities if amenity and amenity.id is not None
        ]
        app.logger.debug("Processed amenities list: %s", amenities_list)
        return jsonify(amenities_list), 200
    except Exception as e:
        app.logger.error("Error fetching amenities: %s", str(e))
        return jsonify({"error": "An error occurred while fetching amenities."}), 500

@main.route('/delete_amenity', methods=['POST'])
def delete_amenity():
    data = request.get_json()
    amenity_name = data.get('name', '').strip()

    if not amenity_name:
        return jsonify(success=False, message="Amenity name cannot be empty.")

    amenity = Amenity.query.filter_by(name=amenity_name).first()
    if not amenity:
        return jsonify(success=False, message="Amenity not found.")

    try:
        db.session.delete(amenity)
        db.session.commit()
        return jsonify(success=True, message="Amenity deleted successfully.")
    except IntegrityError:
        db.session.rollback()
        return jsonify(success=False, message="Database error.")

@main.route('/add_department', methods=['POST'])
def add_department():
    data = request.get_json()
    department_name = data.get('name')

    if department_name:
        existing_department = Department.query.filter_by(name=department_name).first()
        if existing_department:
            return jsonify(success=False, message="Department already exists.")

        new_department = Department(name=department_name)
        db.session.add(new_department)
        db.session.commit()
        return jsonify(success=True, message="Department added successfully.")
    return jsonify(success=False, message="Invalid data.")

@main.route('/get_departments', methods=['GET'])
def get_departments():
    departments = Department.query.all()
    department_list = [{'id': department.id, 'name': department.name} for department in departments]
    return jsonify(department_list)

@main.route('/delete_department', methods=['POST'])
def delete_department():
    data = request.get_json()
    department_name = data.get('name', '').strip()

    if not department_name:
        return jsonify(success=False, message="Department name cannot be empty.")

    department = Department.query.filter_by(name=department_name).first()
    if not department:
        return jsonify(success=False, message="Department not found.")

    try:
        db.session.delete(department)
        db.session.commit()
        return jsonify(success=True, message="Department deleted successfully.")
    except IntegrityError:
        db.session.rollback()
        return jsonify(success=False, message="Database error.")

@main.route('/generate_report/<int:room_id>', methods=['GET'])
@login_required
def generate_report(room_id):
    room = Room.query.get(room_id)
    if not room:
        return jsonify({'status': 'error', 'message': 'Room not found.'}), 404

    selected_month = request.args.get('month')
    selected_year = request.args.get('year')

    sql_query = text("SELECT start_time, end_time FROM room_occupancy WHERE room_id = :room_id")
    params = {"room_id": room_id}

    if selected_month and selected_year and selected_month != "all" and selected_year != "all":
        sql_query = text("""
            SELECT start_time, end_time FROM room_occupancy
            WHERE room_id = :room_id
            AND strftime('%m', start_time) = :month
            AND strftime('%Y', start_time) = :year
        """)
        params.update({
            "month": f"{int(selected_month):02d}",
            "year": selected_year
        })

    occupancy_records = db.session.execute(sql_query, {"room_id": room_id}).fetchall()

    total_seconds = 0
    detailed_usage = []

    for record in occupancy_records:
        start_time, end_time = record
        if start_time and end_time:
            start_time_dt = datetime.fromisoformat(start_time)
            end_time_dt = datetime.fromisoformat(end_time)
            duration = (end_time_dt - start_time_dt).total_seconds()
            total_seconds += duration
            detailed_usage.append({
                'start_time': start_time,
                'end_time': end_time,
                'duration': f"{int(duration // 3600)} hour(s), {int((duration % 3600) // 60)} minute(s)"
            })

    def format_days(seconds):
        return seconds // 86400

    def format_weeks(seconds):
        return seconds // (7 * 86400)

    def format_months(seconds):
        return seconds // (30 * 86400)

    def format_years(seconds):
        return seconds // (365 * 86400)

    total_days = int(format_days(total_seconds))
    total_weeks = int(format_weeks(total_seconds))
    total_months = int(format_months(total_seconds))
    total_years = int(format_years(total_seconds))
    hours_minutes_format = f"{int(total_seconds // 3600)} hour(s) and {int((total_seconds % 3600) // 60)} minute(s)"

    return render_template(
        'report.html',
        room=room,
        room_id=room.room_number,
        total_days=total_days,
        total_weeks=total_weeks,
        total_months=total_months,
        total_years=total_years,
        hours_minutes_format=hours_minutes_format,
        detailed_usage=detailed_usage
    )

@main.route('/reset_report/<int:room_id>', methods=['POST'])
def reset_report(room_id):
    try:
        data = request.get_json()
        selected_month = data.get('month')
        selected_year = data.get('year')

        if selected_month == "all" or selected_year == "all":
            deleted_rows = RoomOccupancy.query.filter_by(room_id=room_id).delete()
        else:
            deleted_rows = RoomOccupancy.query.filter(
                RoomOccupancy.room_id == room_id,
                extract('month', RoomOccupancy.start_time) == int(selected_month),
                extract('year', RoomOccupancy.start_time) == int(selected_year)
            ).delete()

        db.session.commit()
        return jsonify({"message": f"Success: {deleted_rows} record(s) successfully deleted."}), 200

    except Exception as e:
        db.session.rollback()
        return jsonify({"error": f"Error: {str(e)}"}), 500

@main.route('/filter_rooms', methods=['GET'])
def filter_rooms():
    selected_amenities = request.args.getlist('amenities', type=int)
    selected_departments = [int(d) for d in request.args.getlist('department') if d.isdigit()]

    query = Room.query

    if selected_amenities:
        query = query.join(Room.amenities).filter(Amenity.id.in_(selected_amenities)) \
            .group_by(Room.id).having(db.func.count(Amenity.id) == len(selected_amenities))

    if selected_departments:
        query = query.filter(Room.department_id.in_(selected_departments))

    rooms = query.all()
    departments = Department.query.all()
    amenities = Amenity.query.all()

    page = request.args.get("page", "index")
    template = "dashboard.html" if page == "dashboard" else "index.html"

    return render_template(
        template,
        rooms=rooms,
        departments=departments,
        amenities=amenities,
        selected_amenities=selected_amenities,
        selected_departments=selected_departments
    )

@main.route('/add_room', methods=['GET', 'POST'])
def add_room():
    if request.method == 'POST':
        room_name = request.form.get('room_name', '').strip()
        department_id = request.form.get('department')
        selected_amenity_ids = request.form.getlist('amenities')

        if not room_name:
            return jsonify({"error": "Room name cannot be empty."}), 400

        existing_rooms = db.session.query(Room.room_number).all()
        print("Existing rooms:", [r[0] for r in existing_rooms])

        existing_room = db.session.query(Room).filter(
            func.lower(Room.room_number) == func.lower(room_name)
        ).first()

        if existing_room:
            return jsonify({"error": "A room with this name already exists!"}), 400

        new_room = Room(
            room_number=room_name,
            department_id=int(department_id) if department_id else None,
            status="Vacant"
        )
        db.session.add(new_room)

        try:
            db.session.commit()
            print("Room successfully added:", new_room.room_number)
        except IntegrityError:
            db.session.rollback()
            print("Integrity error: Room with this name already exists.")
            return jsonify({"error": "A room with this name already exists!"}), 400

        if selected_amenity_ids:
            try:
                for amenity_id in selected_amenity_ids:
                    db.session.execute(
                        room_amenities.insert().values(room_id=new_room.id, amenity_id=int(amenity_id))
                    )
                db.session.commit()
                print(f"Amenities assigned to room {new_room.room_number}: {selected_amenity_ids}")
            except Exception as e:
                db.session.rollback()
                print(f"Error assigning amenities: {str(e)}")
                return jsonify({"error": "Error assigning amenities."}), 500

        return jsonify({
            "message": "Successfully added a room",
            "room": {"id": new_room.id, "room_number": new_room.room_number}
 }), 200

    amenities = Amenity.query.all()
    departments = Department.query.all()
    return render_template('add_room.html', amenities=amenities, departments=departments)

@main.route('/delete_room', methods=['GET', 'POST'])
def delete_room():
    if request.method == 'POST':
        data = request.get_json()
        room_ids = data.get("room_ids", [])

        if not room_ids:
            return jsonify({"error": "No rooms selected"}), 400

        try:
            room_ids = [int(rid) for rid in room_ids]
            rooms_to_delete = Room.query.filter(Room.id.in_(room_ids)).all()

            if not rooms_to_delete:
                return jsonify({"error": "No valid rooms found"}), 404

            for room in rooms_to_delete:
                db.session.delete(room)

            db.session.commit()

            return jsonify({"message": "Rooms and associated RFID tags deleted successfully"}), 200

        except Exception as e:
            db.session.rollback()
            return jsonify({"error": f"An error occurred: {str(e)}"}), 500

    rooms = Room.query.all()
    return render_template('delete_room.html', rooms=rooms)

@main.route('/add_tag', methods=['GET', 'POST'])
@login_required
def add_tag():
    if request.method == 'POST':
        rfid_tag = request.form['rfid_tag']
        name = request.form['name']
        room_number = request.form.get('assign_room')

        room = None
        if room_number:
            room = Room.query.filter_by(room_number=room_number).first()
            if not room:
                flash("Error: Room does not exist!", "error")
                return redirect(url_for('main.add_tag'))

        existing_tag = RoomRFID.query.filter_by(rfid_tag=rfid_tag).first()
        if existing_tag:
            if existing_tag.name != name:
                flash(f"Error: The tag ID '{rfid_tag}' is already registered with the name '{existing_tag.name}'. Please use the same name.", "error")
                return redirect(url_for('main.add_tag'))

        name_in_other_rfid = RoomRFID.query.filter_by(name=name).filter(RoomRFID.rfid_tag != rfid_tag).first()
        if name_in_other_rfid:
            flash("This name is already assigned to another RFID tag!", "error")
            return redirect(url_for('main.add_tag'))

        new_tag = RoomRFID(rfid_tag=rfid_tag, room_id=room.id if room else None, name=name)
        db.session.add(new_tag)

        try:
            db.session.commit()
            flash("Successfully added the RFID tag to the room!", "success")
        except IntegrityError as e:
            db.session.rollback()
            if "UNIQUE constraint failed" in str(e):
                flash("There is an existing tag in this room", "error")
            else:
                flash(f"Error adding RFID tag: {str(e)}", "error")

        return redirect(url_for('main.add_tag'))

    rooms = Room.query.all()
    return render_template('add_tag.html', rooms=rooms)

@main.route("/delete_tag", methods=["GET", "POST"])
@login_required
def delete_tag():
    if request.method == "POST":
        try:
            data = request.get_json()
            tag_rooms = data.get("tag_ids", [])

            if not tag_rooms:
                return jsonify({"error": "No tags selected."}), 400

            deleted_tags = []

            for tag_room in tag_rooms:
                tag_id = tag_room.get("tag_id")
                room_id = tag_room.get("room_id")

                if not tag_id or room_id is None:
                    continue

                tag_entry = RoomRFID.query.filter_by(rfid_tag=tag_id, room_id=room_id).first()
                if tag_entry:
                    db.session.delete(tag_entry)
                    db.session.commit()

                remaining_room_count = RoomRFID.query.filter_by(rfid_tag=tag_id).count()
                if remaining_room_count == 0:
                    professor_entry = Professor.query.filter_by(rfid_tag=tag_id).first()
                    if professor_entry:
                        db.session.delete(professor_entry)
                        db.session.commit()
                        deleted_tags.append(tag_id)

            return jsonify({"message": "Tags deleted successfully.", "deleted_tag_ids": deleted_tags}), 200

        except Exception as e:
            db.session.rollback()
            return jsonify({"error": str(e)}), 500

    room_tags = (
        db.session.query(RoomRFID.rfid_tag, RoomRFID.name, Room.room_number, RoomRFID.room_id)
        .join(Room, RoomRFID.room_id == Room.id)
        .all()
    )

    professor_tags = (
        db.session.query(Professor.rfid_tag, Professor.name, Room.room_number, Professor.room_id)
        .join(Room, Professor.room_id == Room.id)
        .all()
    )

    formatted_tags = [
        {
            "rfid_tag": tag.rfid_tag,
            "name": tag.name,
            "room_name": tag.room_number,
            "room_id": tag.room_id,
        }
        for tag in room_tags + professor_tags
    ]

    return render_template("delete_tag.html", tags=formatted_tags)
````

---

_**User**_

@workspace /explain semi-colon expected

---

_**Assistant**_

It looks like your selection from `add_room.html` is just a period (`.`), which isn't valid HTML or JavaScript syntax. The error "semi-colon expected" usually appears in JavaScript, not HTML.

**Possible causes:**
- You might have accidentally typed a period in a `<script>` block or in a JavaScript file.
- If you have embedded JavaScript in your HTML, check for missing semicolons or misplaced periods.

**How to fix:**
- If you meant to write JavaScript, ensure statements end with a semicolon (`;`).
- If this is HTML, remove the period.

**Example (JavaScript):**
````javascript
// Correct usage
let roomName = "Conference Room";
console.log(roomName); // semicolon at end
````

**Example (HTML):**
````html
<!-- Correct HTML, no stray periods -->
<div>Add a room</div>
````

If you share more of your code or clarify where the error appears, I can give a more specific fix!

---

